<!DOCTYPE html>
<html lang="en">

<head>

    <title>GharOffice</title>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="mainContainer">
        <div class="header_container">
            <img src="./asserts//download.png" alt="image" class="image" />
        </div>
        <div class="ticketSelection">
            <select name="selecticket" id="ticket">
                <option value="ticketType">Ticket Type</option>
                <option value="Standard">Standard</option>
                <option value="Premium">Premium</option>
            </select>
            <select name="ticketqty" id="qty">
                <option value="Qty">Qty</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>

            </select>
        </div>
        <div class="rowsheetdesign">
            <div class="sheetdesign">
                <div class="sheet" id="sheet">
                    <div class="lsheet" id="lsheet">
                        <p class="ltag">L</p>
                    </div>
                    <div class="lsheet" id="ksheet">
                        <p class="ltag">K</p>
                        <div class="sheetf" id="ksheetf"></div>
                        <div class="sheets" id="ksheets"></div>
                    </div>
                    <div class="lsheet" id="jsheet">
                        <p class="jtag">J</p>
                        <div class="sheetf" id="jsheetf"></div>
                        <div class="sheets" id="jsheets"></div>
                    </div>

                </div>
                <div class="sheet1">
                    <div class="lsheet" id="lsheet">
                        <p class="jtag">H</p>
                        <div class="sheetf" id="hsheetf"></div>
                        <div class="sheets" id="hsheets"></div>
                    </div>
                    <div class="lsheet" id="lsheet">
                        <p class="jtag">G</p>
                        <div class="sheetf" id="gsheetf"></div>
                        <div class="sheets" id="gsheets"></div>
                    </div>
                    <div class="lsheet" id="lsheet">
                        <p class="jtag">F</p>
                        <div class="sheetf" id="fsheetf"></div>
                        <div class="sheets" id="fsheets"></div>
                    </div>
                    <div class="lsheet" id="lsheet">
                        <p class="jtag">E</p>
                        <div class="sheetf" id="esheetf"></div>
                        <div class="sheets" id="esheets"></div>
                    </div>
                </div>
                <div class="button"><button class="buttonStayle" onclick="completeTicketBook()">Proceed</button></div>
            </div>
            <div class="sheetLayout">
                <p>Key to Sheet Layout :</p>
                <di class="availablesheet">
                    <p>Available : </p>
                    <lable class="labletag">
                        </labeltag>
                </di>
                <di class="availablesheet">
                    <p>Unavailable : </p>
                    <lable class="labletag1">
                        </labeltag>
                </di>
                <di class="availablesheet">
                    <p>Selection : </p>
                    <lable class="selectionlable">
                        </labeltag>
                </di>
            </div>
        </div>
    </div>

</body>
<script>
    let lsheet = document.getElementById('lsheet')

    for (let i = 0; i < 19; i++) {  
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "Ltag$id_"+i
        let s = localStorage.getItem(`Ltag$id_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        lsheet.appendChild(tag);
    }
    let ksheet = document.getElementById('ksheetf')
    for (let i = 0; i < 3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "ktag$idf_"+i
        let s = localStorage.getItem(`ktag$idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  

        tag.innerHTML = i+1
        ksheet.appendChild(tag);
    }
    let ksheet2 = document.getElementById('ksheets')
    for (let i=0; i < 8; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "ktag$ids_"+i
        let s = localStorage.getItem(`ktag$ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  

        tag.innerHTML = i+1+3
        ksheet2.appendChild(tag);
    }
    jsheet = document.getElementById('jsheetf')
    for (let i = 0; i < 3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "jtag$idf_"+i
        let s = localStorage.getItem(`jtag$idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        jsheet.appendChild(tag);
    }
    jsheet2 = document.getElementById('jsheets')
    for (let i = 0; i < 9; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "jtag$ids_"+i
        let s = localStorage.getItem(`jtag$ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1+3
        jsheet2.appendChild(tag);
    }
    hsheet = document.getElementById('hsheetf')
    for (let i = 0; i < 3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "htag#idf_"+i
        let s = localStorage.getItem(`htag#idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        hsheet.appendChild(tag);
    }
    hsheet2 = document.getElementById('hsheets')
    for (let i = 0; i < 9; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "htag#ids_"+i
        let s = localStorage.getItem(`htag#ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+3+1
        hsheet2.appendChild(tag);
    }

    gsheet = document.getElementById('gsheetf')
    for (let i = 0; i <3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "gtag#idf_"+i
        let s = localStorage.getItem(`gtag#idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        gsheet.appendChild(tag);
    }
    gsheet2 = document.getElementById('gsheets')
    for (let i = 0; i < 9; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "gtag#ids_"+i
        let s = localStorage.getItem(`gtag#ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1+3
        gsheet2.appendChild(tag);
    }
    fsheet = document.getElementById('fsheetf')
    for (let i = 0; i < 3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "ftag#idf_"+i
        let s = localStorage.getItem(`ftag#idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        fsheet.appendChild(tag);
    }
    fsheet2 = document.getElementById('fsheets')
    for (let i = 0; i < 9; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "ftag#ids_"+i
        let s = localStorage.getItem(`ftag#ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1+3
        fsheet2.appendChild(tag);
    }
    esheet = document.getElementById('esheetf')
    for (let i = 0; i <3; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "etag#idf_"+i
        let s = localStorage.getItem(`etag#idf_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  
        tag.innerHTML = i+1
        esheet.appendChild(tag);
    }
    esheet2 = document.getElementById('esheets')
    for (let i = 0; i < 9; i++) {
        var tag = document.createElement("p");
        tag.className = "ptag"
        tag.id = "etag#ids_"+i
        let s = localStorage.getItem(`etag#ids_${i}`)
        if(s){
            tag.className = 'pbooktag'
        }
        tag.addEventListener('click',bookTicket)  

        tag.innerHTML = i+1+3
        esheet2.appendChild(tag);
    }
    let arr = []
    let select_count = 0
    function bookTicket(e) {
        let ticketType = document.getElementById('ticket');
        ticketType = ticketType.options[ticketType.selectedIndex].value;
        let id = e.path[0].id 
        let length = e.path[1].childElementCount
        let l = id.split('_')
        let data = l[l.length-2]
        l = Number(l[l.length-1])
        let qty  = document.getElementById('qty');
        var  value = Number(qty.options[qty.selectedIndex].value);
        //let s = localStorage.setItem(`${id}`,id)
        let count = 0
        let slength = Number(l)+Number(value)
        //console.log(data)
        if(ticketType === 'ticketType'){
            return alert("Please Select Sheet Type")
        }
        //if(qty.options[qty.selectedIndex].value === 'Qty'){
            //return alert("Please Select Quantity")
        //}
        if(ticketType ==='Standard'){
            //console.log(data)
           if(data.includes('$')){
               if(qty.options[qty.selectedIndex].value === 'Qty'){
                    return alert("Please Select Quantity")
                }
               standardTicketBooking(value,l,length,slength,data)
            }
            else if(data.includes('#')){
                return alert("You can't select Premium Sheet")
            }
            else{
                 return alert("Please Select Quantity")
            }
        }else if(ticketType ==='Premium'){
            //console.log('Premium')
            if(data.includes('#')){
                if(qty.options[qty.selectedIndex].value === 'Qty'){
                    return alert("Please Select Quantity")
                }
                standardTicketBooking(value,l,length,slength,data)
            }
            else if(data.includes('$')){
                alert("You can't select Standard Sheet")
            }
        }
    }
    
    //Standard Ticket Booking
    const standardTicketBooking = (value,l,length,slength,data) => {
        if(select_count==value){
            //console.log("shiv",select_count,arr)
            for(let i=0;i<value;i++){
                //console.log(arr[i],i)
                document.getElementById(arr[i]).style.backgroundColor = '#fff'
            }
            arr = []
            select_count = 0
        }
        for(let i=l;i<slength;i++)
        {
            //console.log(i,select_count,length)
            if(i<length && select_count<value){
                let ldata = localStorage.getItem(`${data}_${i}`)
                console.log("ldata",ldata,`${data}_${i}`)
                if(!ldata){
                   document.getElementById(`${data}_${i}`).style.backgroundColor = 'green'
                   arr.push(`${data}_${i}`)
                   select_count++
                //console.log(select_count)
                }
            }
        }
    }
    function completeTicketBook(){
        console.log("shivchand",arr)
        for(let i=0;i<arr.length;i++){
            localStorage.setItem(`${arr[i]}`,arr[i])
            document.getElementById(arr[i]).style.backgroundColor = '#abaaa7'
        }
        arr = []
        select_count = 0
        alert('Your Booking is Successfull')
    }

    //Sheet Onechange function create for remove sheet start
    document.getElementById('ticket').addEventListener('change', function() {
        if(arr.length!==0){
            for(let i=0;i<arr.length;i++){
                document.getElementById(arr[i]).style.backgroundColor = '#fff'
            }
            arr = []
            select_count = 0
        }
    });
</script>

</html>